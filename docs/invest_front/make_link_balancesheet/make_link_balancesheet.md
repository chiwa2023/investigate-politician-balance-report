# 収支報告書リンク作成【表示画面】設計書

## 状態：Mockデータを用いた一次実装完了

## 1.目的

政治資金収支報告書のバージョンと非公式サイト保存の履歴管理を行う

## 2. 構成コンポーネント

1.[政治団体検索コンポーネント](../../common/front/search_politic_orgnization/search_politic_orgnization.md)
2. 独自フィールド
3.[選挙管理員会検索コンポーネント](../../common/front/search_election_commission/search_election_commission.md)

### 2.1 繰り返し項目

なし

## 3. 画面イメージ

### 3.1 画面イメージ

![収支報告書参照設定](image/収支報告書参照設定.drawio.png)

### 3.2 画面イメージ(項番)

![収支報告書参照設定項番](image/収支報告書参照設定項番.drawio.png)

## 4. フィールド要素一覧

| 番号 |         論理名         |          タイプ          | 活性／表示 |                       内容                       |
| ---- | ---------------------- | ------------------------ | ---------- | ------------------------------------------------ |
| 1    | 政治団体同一識別コード | インプットテキスト       | 非活性     | 選択された政治団体同一識別コードを表示すること。 |
| 1    | 政治団体名称           | インプットテキスト       | 非活性     | 選択された政治団体名称を表示すること。           |
| 1    | 政治団体検索ボタン     | ボタン                   | 活性       | 押下時：政治団体検索コンポーネントを表示すること |
| 1    | 指定年選択             | セレクトボックス         | 活性       | 存在する報告年の選択を受け付けること。           |
| 1    | 最大提出回数変更表示   | インプットテキスト(数字) | 非活性     | 最大提出回数を表示すること。                     |
| 1    | 報告日選択             | セレクトボックス         | 活性       | 報告年に紐づく報告日の選択を受け付けること。     |
| 1    | 公式情報表示エリア     | 領域                     | 表示       | 公式情報について表示すること                     |
| 1    | 非公式情報表示テーブル | テーブル                 | 表示       | 非公式情報について表示すること                   |

### 4.1 公式情報表示エリア フィールド要素一覧

| 番号 |            論理名            |          タイプ          |  活性／表示  |                                                     内容                                                      |
| ---- | ---------------------------- | ------------------------ | ------------ | ------------------------------------------------------------------------------------------------------------- |
| 1    | 報告年                       | インプットテキスト       | 非活性       | 報告年を表示すること                                                                                          |
| 1    | 報告日                       | インプットテキスト       | 非活性       | 報告日を表示すること                                                                                          |
| 1    | 削除ボタン                   | 削除ボタン               | ボタン       | 公式情報の削除入力を受け付けること                                                                            |
| 1    | 選挙管理委員会同一識別コード | インプットテキスト       | 非活性       | 選択された選挙管理委員会同一識別コードを表示すること。                                                        |
| 1    | 選挙管理委員会名称           | インプットテキスト       | 非活性       | 選択された選挙管理委員会名称を表示すること。                                                                  |
| 1    | 選挙管理委員会検索ボタン     | ボタン                   | 活性／非活性 | 押下時：選挙管理委員会検索コンポーネントを表示すること                                                        |
| 1    | 公式リンク入力               | インプットテキスト       | 活性         | 開示された提出選挙管理委員会サイトの収支報告書への絶対リンクの入力を受け付けること                            |
| 1    | リンク切れチェック           | チェックボタン           | 活性         | リンク切れ状態の入力を受け付けること                                                                          |
| 1    | 公式掲載日                   | インプットテキスト(日付) | 活性         | 公式掲載日の入力を受け付けること                                                                              |
| 1    | 参照ボタン                   | ボタン                   | 活性         | 保存済データ参照ページへの遷移を提供すること                                                                  |
| 1    | 読み取りして保存             | ボタン                   | 活性         | 新たに政治資金収支報告書XMLを読み取りし解析可能なこのサイト特有の形式で保存できるページへの遷移を提供すること |

### 4.2 非公式情報表示テーブル フィールド要素一覧

| 番号 |      論理名      |         タイプ          | 活性／表示 |                                                      内容                                                       |
| ---- | ---------------- | ----------------------- | ---------- | --------------------------------------------------------------------------------------------------------------- |
| 1    | 報告年           | ラベル                  | 表示       | 報告年が表示されていること                                                                                      |
| 1    | 提出回数         | ラベル                  | 表示       | 提出回数が表示されていること                                                                                    |
| 1    | サイト名称       | インプットテキスト      | 活性       | 非公式で政治資金収支報告書を保存しているサイト名称の入力を受け付けること                                        |
| 1    | リンクURL        | インプットテキスト(URL) | 活性       | 保存サイトへの絶対リンクの入力を受け付けること                                                                  |
| 1    | 参照ボタン       | ボタン                  | 活性       | 保存済データ参照ページへの遷移を提供すること                                                                    |
| 1    | 読み取りして保存 | ボタン                  | 活性       | 新たに政治資金収支報告書XMLを読み取りし、解析可能なこのサイト特有の形式で保存できるページへの遷移を提供すること |
| 1    | 削除ボタン       | ボタン                  | 活性       | 押下時：この項目を削除すること                                                                                  |
| 1    | 追加ボタン       | ボタン                  | 活性       | 押下時：同一報告年かつ同一報告日の収支報告書を保持している、非公式サイト項目が入力できるようを行を追加すること  |

## 5. アクション一覧

| 番号 |                論理名                |          タイプ          | 活性／表示 |                            内容                            |
| ---- | ------------------------------------ | ------------------------ | ---------- | ---------------------------------------------------------- |
| 1    | キャンセル                           | ボタン                   | 活性       | 押下時：入力内容を破棄すること                             |
| 1    | 保存                                 | ボタン                   | 活性       | 押下時：入力内容を保存すること                             |
| 1    | 政治資金収支報告書検索ボタン         | ボタン                   | 活性       | 押下時：政治資金収支報告書をコンポーネントを表示すること   |
| 1    | 報告年選択                           | セレクトボックス         | 活性       | 選択時：下記に詳細を記述                                   |
| 1    | 提出回数選択                         | セレクトボックス         | 活性       | 選択時：下記に詳細を記述                                   |
| 1    | 提出回数変更インプット               | インプットテキスト(数字) | 活性       | 下記に詳細を記述                                           |
| 1    | 政治資金収支報告書検索ボタン         | ボタン                   | 活性       | 押下時：政治資金収支報告書検索コンポーネントを表示すること |
| 1    | 選挙管理委員会検索ボタン             | ボタン                   | 活性       | 押下時：選挙管理委員会検索コンポーネントを表示すること     |
| 1    | (非公式リンクテーブル)削除ボタン     | ボタン                   | 活性       | 押下時：押下された行を削除すること                         |
| 1    | (非公式リンクテーブル)項目追加ボタン | ボタン                   | 活性       | 押下時：入力行を新たに追加すること                         |

### 5.1報告年選択／報告日選択

- 選択されている報告年、報告日で内部公式データリストをフィルタすること
- 選択されている報告年、報告日で内部非公式データリストをフィルタすること
- フィルタ後の最初の情報で公式情報を更新すること
- 選択されている報告年情報を用いて報告日セレクトボックスを更新すること

### 5.2 初期表示

1. ページ表示時、値`公式政治資金収支報告書リンクId:publicationFormalItemId`を受け取っている場合、報告年、報告日の変更入力を禁止すること

- 政治団体検索ボタンを非活性にすること
- 受け取ったIdをキーに該当するデータを呼び出すこと

2.ページ表示時、値`公式政治資金収支報告書リンクId:publicationFormalItemId`を受け取らない場合は、(対象政治団体が指定されるまで)、特に何もしない

## 6. 政治資金収支報告書／政党交付金使途報告書公式情報インターフェイス

PublicationFormalItemInterface

 |                   論理名                   |          論理名           |                    型                    |                                           説明(例)                                           |
 | ------------------------------------------ | ------------------------- | ---------------------------------------- | -------------------------------------------------------------------------------------------- |
 | 公式収支報告書／使途報告書リンクId         | publicationFormalItemId   | Long                                     | 収支報告書／使途報告書を識別する一意のId                                                     |
 | 公式収支報告書／使途報告書同一識別コード   | publicationFormalItemCode | Integer                                  | 変更履歴にかかわらず収支報告書／使途報告書を識別する一意のId                                 |
 | データセット該否                           | isDataSet                 | Boolean                                  | 公式、非公式ともデータ設定がない場合は`false`                                                |
 | 団体Id                                     | organizationId            | Long                                     | 政党／政治団体を識別する一意のId                                                             |
 | 団体同一識別コード                         | organizationCode          | Integer                                  | 履歴にかかわらず政党／政治団体を識別する一意のコード                                         |
 | 団体名称                                   | organizationName          | String                                   | 政党／政治団体名称                                                                           |
 | 選挙管理委員会Id                           | electionCommitionId       | Long                                     | 選挙管理委員会を識別する一意のId                                                             |
 | 選挙管理委員会同一識別コード               | electionCommitionCode     | Integer                                  | 履歴にかかわらず選挙管理委員会を識別する一意のコード                                         |
 | 選挙管理委員会名称                         | electionCommitionName     | String                                   | 選挙管理委員会名称                                                                           |
 | 報告年                                     | offeringYear              | Integer                                  | 報告年                                                                                       |
 | 提出回数                                   | offeringTimes             | Integer                                  | 提出回数(永続化しない)                                                                       |
 | 報告日                                     | offeringDate              | Date                                     | 報告日                                                                                       |
 | 公式サイト公開該否                         | isClosed                  | Boolean                                  | 公式サイトで情報公開されていることが確認できている場合は`true`                               |
 | 公式(選挙管理委員会)掲載リンク             | publicationLinkUrl        | String                                   | 公式サイトで保存されている使途報告書への絶対リンク                                           |
 | システムへの保存該否                       | isImported                | Boolean                                  | このシステムに解析可能な形で保存されている場合`true`                                         |
 | 公開済収支報告書／使途報告書Id             | publishedBalancesheetId   | Long                                     | 公開されたこのサイトで(作成されていないが)読み取りされた収支報告書／使途報告書書Id           |
 | 公開済収支報告書／使途報告書同一識別コード | publishedBalancesheetCode | Integer                                  | 公開されたこのサイトで(作成されていないが)読み取りされた収支報告書／使途報告書同一識別コード |
 | 非公式データリスト                         | listInformalData          | List\<PublicationInformalDataInterface\> | 非公式サイトへのリンク情報リスト                                                             |

### 6.1 政治資金収支報告書／政党交付金使途報告書非公式情報インターフェイス

PublicationInformalDataInterface

 |                   論理名                   |          論理名           |   型    |                                           説明(例)                                           |
 | ------------------------------------------ | ------------------------- | ------- | -------------------------------------------------------------------------------------------- |
 | 非公式データId                             | publicationInformalId     | Long    | 政党交付金使途報告書を識別する一意のId                                                       |
 | 非公式データ同一識別コード                 | publicationInformalCode   | Integer | 変更履歴にかかわらず政党交付金使途報告書を識別する一意のId                                   |
 | 団体Id                                     | organizationId            | Long    | 政治団体を識別する一意のId                                                                   |
 | 団体同一識別コード                         | organizationCode          | Integer | 履歴にかかわらず団体を識別する一意のId                                                       |
 | 団体名称                                   | organizationName          | String  | 政治団体名称                                                                                 |
 | 報告年                                     | offeringYear              | Integer | 方向年                                                                                       |
 | 提出回数                                   | offeringTimes             | Integer | 提出回数(永続化しない)                                                                       |
 | 報告日                                     | offeringDate              | Date    | 報告日                                                                                       |
 | リンクラベル                               | linkLabel                 | String  | 該当使途報告書を保存している非公式サイト名称                                                 |
 | リンクURL                                  | linkUrl                   | String  | 非公式サイトへの絶対リンク                                                                   |
 | システムへの保存該否                       | isImported                | Boolean | 解析可能な形式でこのサイトで保存されている場合は`true`                                       |
 | 公開済収支報告書／使途報告書Id             | publishedBalancesheetId   | Long    | 公開されたこのサイトで(作成されていないが)読み取りされた収支報告書／使途報告書Id             |
 | 公開済収支報告書／使途報告書同一識別コード | publishedBalancesheetCode | Integer | 公開されたこのサイトで(作成されていないが)読み取りされた収支報告書／使途報告書同一識別コード |

## 7. 連携

TODO 政治団体検索コンポーネント連携
TODO 選挙管理員会検索コンポーネント連携
